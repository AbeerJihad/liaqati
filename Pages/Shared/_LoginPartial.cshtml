@using Microsoft.AspNetCore.Identity
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

@if (SignInManager.IsSignedIn(User))
{

    <div class="d-flex">
        <a href="#" style="max-width:200px !important" class="dropdown-toggle nav-link ms-1 d-flex gap-3  justify-content-center align-items-center" data-bs-toggle="dropdown">


            <span class="user-img" style="width: 52px;
                        height: 52px;
                        font-size: 24px;
                        background: #ebeff3;
                        line-height: 52px;
                        text-align: center;
                        display: inline-block;
                        vertical-align: middle;
                        border-radius: 100%;
                        -webkit-box-shadow: 0 0 10px rgba(0,0,0,.18);
                         box-shadow: 0 0 10px rgba(0,0,0,.18);">
                <img src="@(User.FindFirstValue("Image")??"/Images/user.jpg")" class="w-100 h-100" alt="">

            </span>
            <div class="d-flex  justify-content-center align-items-center flex-column">

                <span style="
        font-weight: 500;
        display: inline-block;
        vertical-align: middle;
        color: #131e22;">
                    مرحبا
                    <span>@User.FindFirstValue("FirstName")</span>
                </span>
                <span class="text-dark text-truncate " style="max-width:100px">
                    @User.FindFirstValue(ClaimTypes.Name)
                </span>
            </div>

        </a>
        <div class="dropdown-menu mt-1" style="border-radius: 10px;">
          @*  <a class="dropdown-item" href="profile.html">
                <i class="bi bi-person me-1"></i>
                الصفحة الشخصية
            </a>*@
            <a class="dropdown-item" asp-page="/Favorites/Index"><i class="bi bi-heart me-1"></i>المفضلة</a>
            <a class="dropdown-item" asp-page="/Cart/Cart"><i class="bi bi-cart3 me-1"></i>سلة المشتريات <span class="text-danger" id="countofcart"></span></a>
            <a class="dropdown-item" asp-page="/account/ChangePassword" asp-area="identity"><i class="bi bi-lock me-1"></i>تغيير كلمة المرور</a>

            <a class="dropdown-item" asp-page="/account/manage/profile/index" asp-area="identity">
                <i class="bi bi-gear me-1"></i>
                الإعدادات
            </a>
            <a class="dropdown-item" asp-page="/account/logout" asp-area="identity">
                <i class="bi bi-box-arrow-right me-1"></i>
                تسجيل خروج
            </a>

        </div>


    </div>
    @*
    <li class="nav-item">
        <div class="accordion-item border-0 shadow-none">
            <h2 class="accordion-header border-0 p-0">
                <button class="accordion-button border-0 px-0"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseThere"
                        aria-expanded="true"
                        aria-controls="collapseThere">
                    <div class="d-flex justify-content-center align-items-center">

                        <div class="position-relative rounded-circle overflow-hidden me-2" style="width: 50px; height:50px">
                            <img src="@User.FindFirstValue("Image")" class="position-absolute w-100 h-100 " alt="">
                        </div>
                        <div>
                            <p class="m-0">
                                مرحبا
                                <span>@User.FindFirstValue("FirstName")</span>
                            </p>

                        </div>
                    </div>
                </button>
            </h2>
            <div id="collapseThere"
                 class="accordion-collapse collapse"
                 aria-labelledby="headingOne"
                 data-bs-parent="#accordionExample">
                <div class="accordion-body p-0">
                    <ul class="sub-menu">
                        <li><a class="sub-menu-item" href="#">Action</a></li>
                        <li>
                            <a class="sub-menu-item" href="#">Another action</a>
                        </li>
                        <li>
                            <form class="is-inline" method="post" asp-page="/Account/logout" asp-area="Identity" asp-route-returnUrl="@Url.Page("/", new { area = "" })">
                                <button type="submit" class="btn btn-danger rounded-pill d-flex    justify-content-center align-items-center ">
                                    <i class="bx bx-log-out  m-0 "></i>
                                    تسجيل الخروج
                                </button>
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </li>
*@
}
else
{
    <li class="nav-item">
        <a class="btn-main col-auto text-white rounded-4  d-inline-block border-0 py-2 px-3" asp-page="/Account/login" asp-area="Identity">
            تسجيل الدخول
        </a>
    </li>
}
@*
            <li class="nav-item">
            <div class="d-flex justify-content-center align-items-center">

                <div class="position-relative rounded-circle overflow-hidden me-2" style="width: 50px; height:50px">
                    <img src="@User.FindFirstValue("Image")" class="position-absolute w-100 h-100 " alt="">
                </div>
                <div>
                    <p class="m-0">
                        مرحبا
                        <span>@User.FindFirstValue("FirstName")</span>
                        <i class="bi bi-chevron-down ms-2"></i>
                    </p>

                </div>
            </div>
        </li>
<form method="post" asp-page="/accounts/login" asp-page-handler="Logout" asp-route-returnUrl="@Url.Page("/", new { area = "" })">
        <button class="btn-main col-auto text-white rounded-4  d-inline-block border-0 py-2 px-3">
        تسجيل الخروج
        </button>
        </form>
        *@