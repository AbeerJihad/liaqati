@page
@model liaqati_master.Pages.MealPlan.MealPlanDetailsModel
@{
}

<link href="~/css/tabs.css" rel="stylesheet" />

<style>
    @@import url("https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&display=swap");

    * {
        font-family: Almarai;
    }

    .hrcolor {
        background-color: #b1abcf;
        height: 3px !important;
        width: 55% !important;
    }

    .pcolor {
        color: #B9AFF5;
    }

    .bgcolor {
        background-color: #F0EFF8;
    }

    .colordiv {
        background-color: #ffffffa9;
    }

    .poss {
        bottom: 0;
        border-radius: 0 0 15px 15px;
    }

    li {
        list-style: none;
    }

    a {
        text-decoration: none;
    }

    .bgsec {
        background-color: #E6E6E6;
    }
</style>
<script>
    window.console = window.console || function (t) { };
</script>
<script>
    if (document.location.search.match(/type=embed/gi)) {
        window.parent.postMessage("resize", "*");
    }
</script>


@if (Model.mealplans != null)
{
    <div class="container">
        <div class="row">
            <div class="d-flex my-2">
            </div>
            <div style="width:100%; height:80%; margin-top:70px;">
                <div class="d-flex my-2">
                    <p class="p-1">الرئيسية</p>
                    <img class="p-1 " width="20" height="25" src="~/img/ic_expand_more_24px.png" />
                    <p class="p-1">خدماتنا</p>
                    <img class="p-1 " width="20" height="25" src="~/img/ic_expand_more_24px.png" />
                    <p class="p-1">أنظمة غذائية</p>

                </div>
                <div>
                    <img class="w-100" height="480" src="~/@Model.mealplans.Image" />
                </div>
            </div>

            <!--section1-->
            <div class="row my-3 justify-content-between">
                <div class="col-8 col-md-6">
                    <h4>@Model.mealplans.Services?.Title</h4>
                    <p class="my-4">برنامج كامل لمدة @Model.days يوم </p>
                    <div class="rating">
                        <div class="rating position-relative">
                            <div class="rating-upper d-flex ">
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                            </div>
                            <div class="rating-lower d-flex  position-absolute top-0 start-0 overflow-hidden  w-@Model.mealplans.Services?.RatePercentage">
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-4 col-md-2 p-0">
                    <a class="btn px-3 py-2 fs-5 text-white rounded-3 shadow" style="background-color: #B9AFF5;" asp-page="Clender" asp-route-Id="@Model.mealplans.Id">
                        ابدأ الآن
                        <img class="me-2" src="~/img/Mask Group 56.png" />
                    </a>
                </div>
            </div>
            <!--section2-->
            <div class="row col-10 m-auto my-3">
                <div class="col-sm-6 col-md-4 my-4 d-flex">
                    <img height="60" src="~/img/Group 72.png" />
                    <p class=" fs-5 my-auto mx-2">مدة البرنامج @Model.days يوم </p>
                </div>
                <div class="col-sm-6 col-md-4 my-4 d-flex">
                    <img height="60" src="~/img/Group 70.png" />
                    <p class="my-auto  fs-5 mx-2">متوسط وقت الوجبة @Model.mealplans.AvgRecipeTime دقيقة </p>
                </div>
                <div class="col-sm-7 col-md-4 d-flex  my-4  m-sm-auto">
                    <img height="60" src="~/img/Group 701.png" />
                    <p class="my-auto  fs-5 mx-2"> @Model.mealplans.BurnEstimate سعرة حرارية </p>
                </div>
            </div>
            <!--section3-->
            <hr class="col-12" />
            <div class="row my-2 justify-content-between">
                <div class="col-12 col-md-8">
                    <h4 class="fw-bold">تفاصيل البرنامج</h4>
                    <hr style="height: 3px;color: #CEBFE9; width: 13% " />
                    <div class="">
                        <div class="d-flex m-2">
                            <h5>متوسط وقت الوجبة:</h5>
                            <p class="mx-4">@Model.mealplans.AvgRecipeTime دقيقة</p>
                        </div>
                        <div class="d-flex  m-2">
                            <h5>عدد المشتركين:</h5>
                            <p class="mx-4"> @Model.mealplans.Numsubscribers</p>
                        </div>
                        <div class="d-flex  m-2">
                            <h5>المدرب:</h5>
                            <p class="mx-4">@Model.mealplans.Services?.User?.Fname </p>
                        </div>
                    </div>
                    <!--tab-->
                    <div class="col-md-12" translate="no">
                        <div class="cd-tabs  m-0">
                            <div class="container">
                                <div class="row">
                                    <div class="d-flex m-0 p-0 justify-content-start">

                                        <ul class="cd-tabs-navigation m-0 d-flex">
                                            <li class="m-0 px-3">
                                                <a data-content="detl" class="selected" href="#0">
                                                    ملخص
                                                    النظام الغذائي
                                                </a>
                                            </li>
                                            <li class="m-0 p-0"><a data-content="Tabl" href="#0">جدول النظام الغذائي</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="container">
                                <div class="row">
                                    <div class="col-12 m-0 p-0">
                                        <ul class="cd-tabs-content m-0 p-0">
                                            <li class="selected" data-content="detl">
                                                <p class="lh-base">
                                                    @Model.mealplans.Services?.Description
                                                </p>
                                                <p class="lh-base d-block">
                                                    @Model.mealplans.Services?.Description
                                                </p>
                                            </li>
                                            <li data-content="Tabl" class="col-12 m-0 p-0">
                                                <div class="row my-2 d-flex flex-wrap" id="WeekRow">
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--card-->
                <div class="col-12 col-lg-4 ">
                    <div class="col-11 p-4 bgcolor mt-2 me-5">
                        <h5 class="fw-bold">بعض المقالات المفيدة لك</h5>
                        <!--card1-->
                        @foreach (var item in Model.Articles)
                        {
                            <div class="card mb-3 shadow-sm">
                                <div class="row g-0">
                                    <div class="col-4">
                                        <img src="@item.Image" class="img-fluid h-100" alt="...">
                                    </div>
                                    <div class="col-8">
                                        <div class="card-body">
                                            <p class="card-title text-secondary fw-bold">@item.Category</p>
                                            <p class="card-text lh-base">@item.Title</p>
                                            <div class="d-flex justify-content-end">
                                                <img height="20" src="~/img/heart-svgrepo-com (1).png" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
            <!--section4-->
            <div class=" m-3">
                <div class="col-12 col-md-4 m-auto">
                    <h3 class="m-3">جرب هذه التمارين لبناء كتلة عضلية</h3>
                    <div class="m-auto hrcolor"></div>
                </div>
                <div class="row justify-content-around my-4">
                    @foreach (var item in @Model.exercises)
                    {
                        <di class="col-sm-6 col-lg-3 p-4 ">
                            <div class="card border-0 h-100 ">
                                <div class="position-relative">
                                    <img id="imgCard " src="@item.Image" style="width:100%;" />
                                    <img width="40" class="position-absolute"
                                         alt=""
                                         srcset="" />
                                    <img width="70"
                                         class="position-absolute"
                                         style="bottom: 20px; right: 20px"
                                         src="./Images/Exercise/ic_play_circle_outline_24px.png"
                                         alt=""
                                         srcset="" />
                                </div>
                                <div class="card-body">
                                    <p class="card-text  Exercises_duration_Color fw-bold">
                                        @item.Duration دقيقة/اليوم
                                    </p>
                                    <h6 class="card-title mb-3"> @item.Title   </h6>
                                    <div class="">
                                        <div class="rating mt-2  ">
                                            <div class="rating position-relative">
                                                <div class="rating-upper d-flex  ">
                                                    <i class="bi bi-star-fill text-black-50"></i>
                                                    <i class="bi bi-star-fill text-black-50"></i>
                                                    <i class="bi bi-star-fill text-black-50"></i>
                                                    <i class="bi bi-star-fill text-black-50"></i>
                                                    <i class="bi bi-star-fill text-black-50"></i>
                                                </div>
                                                <div class="rating-lower d-flex  position-absolute top-0 start-0 overflow-hidden  w-@item.RatePercentage ">
                                                    <i class="bi bi-star-fill text-warning"></i>
                                                    <i class="bi bi-star-fill text-warning"></i>
                                                    <i class="bi bi-star-fill text-warning"></i>
                                                    <i class="bi bi-star-fill text-warning"></i>
                                                    <i class="bi bi-star-fill text-warning"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-between mt-2">
                                            <div>
                                                <h4 class="d-inline-block text-danger align-middle">
                                                    <span>مجانا</span>
                                                </h4>
                                            </div>
                                            <div>
                                                <button class="btn_Exercises_duration col-auto text-white rounded-3 fw-bold d-inline-block border-0 py-1 px-2" style="background-color:#BE8ADC;">
                                                    ابدا الان
                                                    <img src="/images/Exercise/cart.png" />
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </di>
                    }
                </div>
            </div>
        </div>
    </div>
    <!--Comments-->
    <div class="container-fluid my-5 p-5  bgcolor">
        <div class="row col-12 d-flex justify-content-around">
            <h2 class="text-center">آراء مستخدمينا</h2>
            <p class="text-center mt-1">جمعنا لكم أراء مستخدمي برامج لياقتي</p>
            @foreach (var comment in @Model.comments)
            {
                <div class="col-12 col-md-3  my-4">
                    <div class="d-flex m-3">
                        <img class="rounded-circle" height="60" width="60" src="~/@comment.Image" style="object-fit:cover" />

                        <p class="colorP  my-auto mx-2">@comment.Name</p>
                    </div>
                    <div class="rating mt-2  ">
                        <div class="rating position-relative">
                            <div class="rating-upper d-flex  ">
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                                <i class="bi bi-star-fill text-black-50"></i>
                            </div>
                            <div class="rating-lower d-flex  position-absolute top-0 start-0 overflow-hidden  w-@comment.RatePercentage ">
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                            </div>
                        </div>
                    </div>
                    <p class="mt-3">@comment.Comment</p>
                </div>
            }
        </div>
    </div>
};

<script src="~/JavaScript/mealprogramDetails.js"></script>

<script src="https://cpwebassets.codepen.io/assets/common/stopExecutionOnTimeout-2c7831bb44f98c1391d6a4ffda0e1fd302503391ca806e7fcc7b9b87197aec26.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script id="rendered-js">
    jQuery(document).ready(function ($) {
        var tabs = $('.cd-tabs');

        tabs.each(function () {
            var tab = $(this),
                tabItems = tab.find('ul.cd-tabs-navigation'),
                tabContentWrapper = tab.find('ul.cd-tabs-content'),
                tabNavigation = tab.find('nav');

            tabItems.on('click', 'a', function (event) {
                event.preventDefault();
                var selectedItem = $(this);
                if (!selectedItem.hasClass('selected')) {
                    var selectedTab = selectedItem.data('content'),
                        selectedContent = tabContentWrapper.find('li[data-content="' + selectedTab + '"]'),
                        slectedContentHeight = selectedContent.innerHeight();

                    tabItems.find('a.selected').removeClass('selected');
                    selectedItem.addClass('selected');
                    selectedContent.addClass('selected').siblings('li').removeClass('selected');
                    //animate tabContentWrapper height when content changes
                    tabContentWrapper.animate({
                        'height': slectedContentHeight
                    },
                        200);
                }
            });

            //hide the .cd-tabs::after element when tabbed navigation has scrolled to the end (mobile version)
            checkScrolling(tabNavigation);
            tabNavigation.on('scroll', function () {
                checkScrolling($(this));
            });
        });

        $(window).on('resize', function () {
            tabs.each(function () {
                var tab = $(this);
                checkScrolling(tab.find('nav'));
                tab.find('.cd-tabs-content').css('height', 'auto');
            });
        });

        function checkScrolling(tabs) {
            var totalTabWidth = parseInt(tabs.children('.cd-tabs-navigation').width()),
                tabsViewport = parseInt(tabs.width());
            if (tabs.scrollLeft() >= totalTabWidth - tabsViewport) {
                tabs.parent('.cd-tabs').addClass('is-ended');
            } else {
                tabs.parent('.cd-tabs').removeClass('is-ended');
            }
        }
    });
    //# sourceURL=pen.js
</script>
<!--Show and hidden tabel of mealPlan-->
<script>
    const numbersToWords = {
        0: "0",
        1: "الأول",
        2: "الثاني",
        3: "الثالث",
        4: "الرابع",
        5: "الخامس",
        6: "السادس",
        7: "السابع",
        8: "الثامن",
        9: "التاسع",
        10: "العاشر",
    };
    function convertNumberToWords(number) {
        // if number present in object no need to go further
        if (number in numbersToWords) return numbersToWords[number];
    }
    var testConditionl;
    let WeekRow = document.getElementById("WeekRow");
    for (var x = 1; x <= @Model.mealplans.Length ; x++) {
        MappingWeeks(x);
    }
    function MappingWeeks(week) {
        var row = document.createElement("div");
        row.className = "d-flex  my-2 col-12 m-0 p-0 col-md-6 exRow";
        var weekTitle = document.createElement("div");
        weekTitle.className = "d-block";
        let num = week;
        let text = convertNumberToWords(num);
        weekTitle.innerHTML = `<h5>الأسبوع ${text} </h5>`;
        WeekRow.appendChild(weekTitle);
        for (var y = 1; y <= 7; y++) {
            MappingDays(row, week, y);
        }
        var row2 = document.createElement("div");
        row2.className = "row my-2 ";
        row2.id = `row${x}`;
        WeekRow.appendChild(row);
        WeekRow.appendChild(row2);
    }
    async function MappingDays(rows, week, day) {
        var col = document.createElement("div");
        let num = day;
        let text = convertNumberToWords(num);
        var ExerApi = await countHealthyMeal(@Model.mealplans.Id, week, day);
        col.innerHTML = `<div  onClick=" ShowExer(${@Model.mealplans.Id}, ${week} , ${day} )"
                                                                      <button class="btn p-0  m-1"  type="button">
                                                                    <div class="me-0 shadow border border-dark p-3 rounded-3">
                                                                      <p class="fs-6"> اليوم </p>
                                                                       <div class="bgsec mx-3 shadow d-flex justify-content-center rounded-circle">
                                                                        <p class="p-3  fw-bold  m-auto"><span> ${ExerApi.count}</span>
                                                                       </p>
                                                                        </div>
                                                                        </div>
                                                                        </button>
                                                                      </div>
                                                                     `;
        rows.appendChild(col);
    }
    async function ShowExer(id, week, day) {
        var test = "" + week + "" + day;
        var ExerApi = await countHealthyMeal(id, week, day);
        var rowShowExer = document.getElementById(`row${week}`);

        //!(rowShowExer.innerHTML.length > 0)
        if (testConditionl !== test) {
            rowShowExer.innerHTML = "";
            for (var m = 0; m < ExerApi.count; m++) {
                var num = m + 1;
                let text = convertNumberToWords(num);
                var d = document.createElement("div");
                d.className = "col-12";
                // d.style.backgroundColor = "red";
                d.innerHTML = `  <!--<h5 class="my-3">اليوم الاول</h5>
                                                                                                    <div class="card mb-3 col-md-6  shadow-sm">
                                                                                                    <div class="row g-0">
                                                                                                    <div class="col-4">
                                                                                                    <img src="${ExerApi.list[m].Meal_Healthy.image}" class="img-fluid h-100" alt="...">
                                                                                                    </div>
                                                                                                    <div class="col-8 my-auto">
                                                                                                    <div class="card-body ">
                                                                                                    <p class="card-title fs-6  text-secondary fw-bold"></p>
                                                                                                    <p class="card-text">حمص بالبيض مع صوص البندورة</p>
                                                                                                    </div>
                                                                                                    </div>
                                                                                                    </div>
                                                                                                    </div>
                                                                        `;
                rowShowExer.appendChild(d);
            }
            testConditionl = "" + week + "" + day;
        }
        else {
            rowShowExer.innerHTML = "";
            testConditionl = "";
        }
    }
</script>
