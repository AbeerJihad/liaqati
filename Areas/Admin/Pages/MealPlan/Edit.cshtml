@page
@model liaqati_master.Pages.MealPlan.EditModel
@{
    ViewData["Title"] = "إضافة إنجاز";
    ViewData["LinkName"] = "Categories";
}


<div class="modal fade" id="editMealHealthyModel" tabindex="-1" aria-labelledby="editLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editLabel">Edit </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="frmCRUD" method="post" asp-page-handler="EditMealHealthy">
                <div class="modal-body">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <input asp-for="Meal_Healthy.Id" id="ExerciesprogramID" hidden />
                    <input asp-for="Meal_Healthy.MealPlansId" id="Exercies_ProgramsportsProgramId" hidden />

                    <div class="form-group">
                        <div class="mb-3">
                            <label class="d-block"> اختر اليوم</label>
                            <select asp-for="Meal_Healthy.Day" style="height:35px;" class="col-12 border border-light rounded-3" id="selectDays"
                                    placeholder="اكتب شيئاً...">
                                <option value="1">اليوم الاول</option>
                                <option value="2">اليوم الثاني</option>
                                <option value="3">اليوم الثالث</option>
                                <option value="4">اليوم الرابع</option>
                                <option value="5">اليوم الخامس</option>
                                <option value="6">اليوم السادس</option>
                                <option value="7">اليوم السابع</option>
                            </select>

                        </div>
                    </div>
                    <div class="form-group">
                        <div class="mb-3">
                            <label class="d-block" asp-for="Meal_Healthy.Week"></label>
                            <select style="height:35px;" class="col-12 border border-light rounded-3" id="selectLength" asp-for="Meal_Healthy.Week">
                                <option value="-1">ادخل عدد اسابيع النظام الرياضي</option>
                                <option value="1">الاسبوع الاول</option>
                                <option value="2">الاسيوع الثاني</option>
                                <option value="3">الاسيوع الثالث</option>
                                <option value="4">الاسيوع الرابع </option>
                            </select>
                            <span class="text-danger" asp-validation-for="MealPlans.Length"></span>

                        </div>
                    </div>


                    <div class="form-group">
                        <div class="mb-3">
                            <label class="d-block"> اختر التمارين الخاصة بالنظام الرياضي</label>
                            <select id="Exercie" asp-items="Model.HealthyName" asp-for="Meal_Healthy.HealthyRecdpeId" style="height:35px;" class="col-12 border border-light rounded-3">
                                <option value="-1"> اختر الوصفة</option>
                            </select>
                        </div>
                    </div>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button id="ptnadd" type="submit" class="btn btn-primary" >Save</button>
                </div>
            </form>
        </div>
    </div>
</div>



<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <div class="card">
                <div class="card-body">
                    <h3 class="pb-3">@ViewData["Title"]</h3>

                    <form asp-page-handler="Add" method="post" class="form theme-form">
                        <input id="IdMeal" asp-for="MealPlans.Id"  class="form-control" placeholder="">

                        <div asp-validation-summary="All"></div>
                        <div class="row">
                            <div class="col">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.Services!.Title"></label>
                                    <input asp-for="MealPlans.Services!.Title" class="form-control" placeholder="">
                                    <span asp-validation-for="MealPlans.Services!.Title" class="text-danger"></span>

                                </div>
                            </div>
                            <div class="col">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.Services!.Price"></label>
                                    <input asp-for="MealPlans.Services!.Price" class="form-control" placeholder="">
                                    <span asp-validation-for="MealPlans.Services!.Price" class="text-danger"></span>

                                </div>
                            </div>

                            <div class="col-12">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.Services!.Description"></label>
                                    <textarea asp-for="MealPlans.Services!.Description" class="form-control rich-editor" placeholder=""></textarea>
                                    <span asp-validation-for="MealPlans.Services!.Description" class="text-danger"></span>

                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.MealType"></label>
                                    <br />
                                    @for (var index = 0; index < @Model.lstCheckBox.Count(); index++)
                                    {
                                        <label class="form-check-label p">
                                            @Model.MealType[index]
                                        </label>
                                        <input type="hidden" asp-for="@Model.lstCheckBox[index].Name" />

                                        <input type="checkbox" asp-for="@Model.lstCheckBox[index].IsChecked" />


                                        if ((index + 1) % 3 == 0)
                                        {
                                            <br />
                                        }
                                    }





                                    @*                                    <input asp-for="MealPlan.MealType" class="form-control" placeholder="">
                                    *@                                    <span asp-validation-for="MealPlans.MealType" class="text-danger"></span>

                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.DietaryType"></label>
                                    @*                                  <input asp-for="MealPlan.DietaryType" class="form-control" placeholder="">
                                    *@
                                    <label asp-for="MealPlans.DietaryType"></label>
                                    <br />
                                    @for (var index = 0; index < @Model.lstCheckBoxDietaryType.Count(); index++)
                                    {
                                        <label class="form-check-label p">
                                            @Model.DietaryType[index]
                                        </label>
                                        <input type="hidden" asp-for="@Model.lstCheckBoxDietaryType[index].Name" />

                                        <input checked="@Model.lstCheckBoxDietaryType[index].IsChecked" type="checkbox" asp-for="@Model.lstCheckBoxDietaryType[index].IsChecked" />


                                        if ((index + 1) % 3 == 0)
                                        {
                                            <br />
                                        }
                                    }
                                    <span asp-validation-for="MealPlans.DietaryType" class="text-danger"></span>

                                </div>
                    
                            
                            </div>


                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.Length"></label>
                                    <input asp-for="MealPlans.Length" class="form-control" placeholder="">
                                    <span asp-validation-for="MealPlans.Length" class="text-danger"></span>

                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.AvgRecipeTime"></label>
                                    <input asp-for="MealPlans.AvgRecipeTime" class="form-control" placeholder="">

                                    <span asp-validation-for="MealPlans.AvgRecipeTime" class="text-danger"></span>
                                </div>
                            </div>
                           @* <div class="col-sm-4">
                                <div class="mb-3">
                                    <label asp-for="MealPlans.Services!.Category!.Name"></label>
                                    <select asp-for="MealPlans.Services!.CategoryId" asp-items="Model.CatogeryName">
                                        <option disabled value="-1">Please Select Catogery Name</option>

                                    </select>
                                    <span asp-validation-for=" MealPlans.Services!.CategoryId" class="text-danger"></span>

                                </div>
                            </div>
                     *@
                        
                        </div>


                        <div>
                            @{
                                if (Model.MealPlans.Meal_Healthy != null)
                                {
                                    <table class="table table-striped table-hover table-bordered table-responsive">
                                        <thead class="table-Secondary">
                                            <tr>

                                                <th scope="col">الاسبوع</th>
                                                <th scope="col">اليوم</th>
                                                <th scope="col"> اسم الوصفة</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tableBodyApi">



                                            @for (int x = 0; x < Model.MealPlans.Meal_Healthy!.Count; x++)
                                            {

                                                string? id = Model.MealPlans.Meal_Healthy[x].HealthyRecdpeId;
                                                var exercise = await Model.getHealthy(id);



                                                <tr class="bg-Success">
                                                    <td> الاسبوع @Model.MealPlans.Meal_Healthy[x].Week   </td>
                                                    <td> اليوم @Model.MealPlans.Meal_Healthy[x].Day   </td>
                                                    <td>@exercise?.Title</td>

                                                    <td>
                                                        @{
                                                            var item = Model.MealPlans.Meal_Healthy[x];
                                                            item.HealthyRecipe = null;
                                                            item.MealPlan = null;
                                                        }
                                                        <a class="btn" onclick="ShowMealHealthyModelEdit('editMealHealthyModel',@System.Text.Json.JsonSerializer.Serialize(item))"
                                                   style="background-color: #8763b320; color:#3c077d;   padding: 0.375rem 0.75rem;">
                                                            <i class="bi bi-pencil-square"></i>
                                                        </a>
                                                    </td>
                                                    <td>
                                                        <form id="formDeleteProgramExercies" method="post" asp-page-handler="DeleteMealHealthy" asp-route-id="@Model.MealPlans.Meal_Healthy[x].Id">
                                                            <button hidden type="submit"></button>
                                                            <a id="xxx" onclick="DeleteFun(this)" style=" background-color: #d22d3d20; color:#d22d3d;padding: 0.375rem 0.75rem;"> <i class="bi bi-trash"></i> </a>
                                                        </form>


                                                    </td>

                                                </tr>

                                            }
                                        </tbody>
                                    </table>
                                }
                            }
                        </div>




                        <div class="row justify-content-end ">
                            <div class="col-sm-4 justify-content-end d-flex">
                                <div class="mb-3">
                                    <button class="btn-primary btn  mx-auto col-auto" type="submit"> حقظ التعديلات <i class="bi bi-plus-square-dotted"></i> </button>
                                    <a class="btn-danger btn  mx-auto col-auto" asp-page="./Index"> الغاء <i class="bi bi-arrow-90deg-down"></i></a>
                                </div>
                            </div>
                        </div>
                  
                    
                    
                    
                    </form>
                </div>
            </div>
        </div>
    </div>


   



</div>




<div id="DivSystem" class="container-lg my-5 ">
    <div class="row justify-content-center my-5">
        <div data-v-2eea9796="" class="col-md-12">
            <div class="field-value">
                <div class="form-label d-flex flex-row align-items-center justify-content-between">
                    <div></div>
                </div>
                <div class="bg-white p-4">

                    <div class="row">
                        <div class="col">
                            <div class="mb-3">
                                <label>اختر الاسبوع </label>
                                <select style="height:35px;" class="col-12 border border-light rounded-3" name="Week" id="selectLengthWeek">
                                    <option disabled value="-1">اختر الاسبوع</option>

                                    @for (int x = 1; x <= Model.MealPlans!.Length; x++)
                                    {
                                        <option value="@x">  الاسبوع @x</option>

                                    }


                                </select>
                            </div>

                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label class="d-block"> اختر اليوم</label>
                                <select style="height:35px;" class="col-12 border border-light rounded-3" id="selectDays"
                                        placeholder="اكتب شيئاً...">
                                    <option value="1">اليوم الاول</option>
                                    <option value="2">اليوم الثاني</option>
                                    <option value="3">اليوم الثالث</option>
                                    <option value="4">اليوم الرابع</option>
                                    <option value="5">اليوم الخامس</option>
                                    <option value="6">اليوم السادس</option>
                                    <option value="7">اليوم السابع</option>
                                </select>

                            </div>

                        </div>
                        <div class="col-12">
                            <div class="mb-3">
                                <label class="d-block"> اختر الوصفات  الخاصة بالنظام الغذائي</label>
                                <select required onchange="SelectExerciseFun()" style="height:35px;" class="col-12 form-control  border border-light rounded-3 select2_Exercises" id="SelectHealthy" multiple="multiple">
                                    <option value=""> اختر الوصفات</option>
                                </select>
                            </div>

                        </div>

                        <div class="col-auto py-4">
                            <form id="formProgramSystem" method="post" asp-page="Edit" asp-page-handler="AddSystem">
                                <input name="Id" value="@Model.MealPlans.Id" id="IdProg" name="id" asp-for="MealPlans.Id" hidden />

                                <a id="BtnAddHealtyMeal"
                                   class="text-nowrap bg-white fw-medium btn btn-outline-primary">
                                    <i class="bi bi-plus h5 fw-bold"></i>
                                </a>
                            </form>

                        </div>



                    </div>












                </div>


            </div>

        </div>
    </div>
</div>



<div>
    <a asp-page="Index">Back to List</a>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");


    }<script src="~/javascript/script.js"></script>
    <script src="~/jsapi/healthyapi.js"></script>
    <script src="~/jsapi/healthyrecipeapi/gethealthy.js"></script>
    <script src="~/jsapi/mealhealthy.js"></script>
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    <script src="~/javascript/richtexteditor.js" asp-append-version="true"></script>

    <script src="~/lib/sweetalert2/sweetalert2.min.js"></script>




}
